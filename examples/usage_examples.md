# Draw.io 架构图 MCP 服务使用示例

本文档提供了使用 Draw.io 架构图 MCP 服务的详细示例。

## 1. 生成基础架构图

### 示例 1: 简单的三层架构

**用户输入**:
```
请帮我生成一个简单的三层架构图，包括：
- 表现层：Web前端
- 业务层：应用服务器
- 数据层：数据库
```

**AI 助手响应**:
AI 助手会调用 `generate_architecture_diagram` 工具，生成包含三层架构的 draw.io 文件。

### 示例 2: 微服务电商架构

**用户输入**:
```
请生成一个电商系统的微服务架构图，要求包括：

客户端层：
- Web端（React）
- 移动端（iOS/Android）
- 小程序（微信/支付宝）

接入层：
- API网关（Kong）
- 负载均衡（Nginx）
- CDN（CloudFlare）

微服务层：
- 用户服务（注册登录、用户管理）
- 商品服务（商品管理、库存管理）
- 订单服务（订单创建、状态跟踪）
- 支付服务（支付处理、退款管理）
- 通知服务（短信、邮件、推送）

中间件层：
- Redis集群（缓存、会话）
- 消息队列（RabbitMQ）
- Elasticsearch（搜索、日志）
- 配置中心（Nacos）

数据存储层：
- MySQL主从（用户、订单数据）
- MongoDB（商品、日志数据）
- 对象存储（OSS，图片文件）

请保存为 ecommerce_architecture.drawio
```

**工具调用参数**:
```json
{
  "description": "电商系统微服务架构，包含客户端层(Web/移动端/小程序)、接入层(API网关/负载均衡/CDN)、微服务层(用户/商品/订单/支付/通知服务)、中间件层(Redis/MQ/ES/配置中心)、数据存储层(MySQL主从/MongoDB/OSS)",
  "diagram_name": "电商系统微服务架构",
  "output_file": "./ecommerce_architecture.drawio"
}
```

## 2. 获取专业提示词

### 示例 3: 获取提示词模板

**用户输入**:
```
我想了解如何绘制专业的架构图，请提供相关的提示词模板
```

**AI 助手响应**:
AI 助手会调用 `get_architecture_prompt` 工具，返回完整的专业提示词模板，包括：
- 角色定义
- 核心能力
- 工作流程
- 绘制规范
- XML格式要求
- 专业建议

## 3. 验证文件格式

### 示例 4: 验证现有文件

**用户输入**:
```
请验证这个文件的格式是否正确：./my_architecture.drawio
```

**工具调用参数**:
```json
{
  "file_path": "./my_architecture.drawio"
}
```

**可能的验证结果**:
```
文件验证结果 (./my_architecture.drawio):

✅ XML声明正确
✅ mxfile根元素存在
✅ diagram元素存在
✅ mxGraphModel元素存在
❌ 发现未转义的HTML标签: 3个
```

### 示例 5: 修复格式问题

如果验证发现问题，可以要求 AI 助手修复：

**用户输入**:
```
文件中有未转义的HTML标签，请帮我修复这些问题
```

AI 助手会分析文件内容，找到并修复所有格式问题。

## 4. 复杂架构示例

### 示例 6: 云原生架构

**用户输入**:
```
请生成一个云原生架构图，包括：

容器化层：
- Docker容器
- Kubernetes集群
- Helm包管理

服务网格：
- Istio服务网格
- Envoy代理
- 流量管理

可观测性：
- Prometheus监控
- Grafana可视化
- Jaeger链路追踪
- ELK日志栈

 CI/CD：
- GitLab CI/CD
- Harbor镜像仓库
- ArgoCD部署

存储：
- 持久化存储（PV/PVC）
- 对象存储（MinIO）
- 数据库（PostgreSQL集群）
```

### 示例 7: 大数据架构

**用户输入**:
```
设计一个大数据处理架构，要求：

数据采集层：
- Flume日志采集
- Kafka消息队列
- Sqoop数据导入

数据存储层：
- HDFS分布式存储
- HBase NoSQL数据库
- Hive数据仓库

数据处理层：
- Spark批处理
- Storm流处理
- Flink实时计算

数据服务层：
- Presto查询引擎
- Kylin OLAP引擎
- Elasticsearch搜索

数据应用层：
- BI报表系统
- 实时监控大屏
- 数据API服务
```

## 5. 自定义样式示例

### 示例 8: 指定颜色主题

**用户输入**:
```
生成一个系统架构图，使用蓝色主题，包括：
- 前端服务（浅蓝色）
- 后端服务（深蓝色）
- 数据库（蓝灰色）
```

### 示例 9: 添加图标和说明

**用户输入**:
```
创建一个带有详细说明的架构图：
- 每个组件包含技术栈信息
- 添加数据流向箭头
- 标注关键的性能指标
- 包含安全边界标识
```

## 6. 故障排除示例

### 示例 10: 文件无法打开

**问题**: draw.io 提示 "Not a diagram file"

**解决步骤**:
1. 使用验证工具检查文件
2. 查看具体错误信息
3. 修复XML格式问题
4. 重新验证文件

**用户输入**:
```
我的架构图文件无法在draw.io中打开，提示"Not a diagram file"，请帮我检查和修复
```

### 示例 11: 性能优化

**用户输入**:
```
我的架构图文件很大，加载很慢，有什么优化建议吗？
```

**AI 助手建议**:
- 减少不必要的图形元素
- 优化图片和图标使用
- 简化复杂的连接线
- 分层展示复杂架构

## 7. 集成示例

### 示例 12: 与文档集成

**用户输入**:
```
请生成架构图，并同时创建对应的技术文档，包括：
- 架构概述
- 组件说明
- 技术选型理由
- 部署指南
```

### 示例 13: 版本管理

**用户输入**:
```
请为我的系统创建三个版本的架构图：
- v1.0: 单体架构
- v2.0: 微服务架构
- v3.0: 云原生架构

每个版本保存为独立文件
```

## 8. 最佳实践

### 命名规范
- 使用有意义的文件名：`{项目名}_{架构类型}_{版本}.drawio`
- 图表名称要清晰："XX系统微服务架构图 v2.1"

### 层次结构
- 从上到下：客户端 → 接入 → 业务 → 数据
- 从左到右：请求流向或数据流向

### 颜色使用
- 同类组件使用相同颜色
- 重要组件使用醒目颜色
- 保持整体色调协调

### 文档维护
- 定期更新架构图
- 保持与实际系统一致
- 添加版本说明和更新日志

## 9. 常见问题解答

**Q: 如何添加自定义图标？**
A: 在描述中指定图标需求，MCP服务会生成相应的图形元素。

**Q: 支持导出其他格式吗？**
A: 目前主要支持draw.io格式，可以在draw.io中导出为PNG、SVG、PDF等格式。

**Q: 如何处理大型复杂架构？**
A: 建议分层绘制，创建多个相关的架构图，每个图专注于特定层面。

**Q: 可以自定义样式模板吗？**
A: 可以通过修改MCP服务器代码中的样式定义来自定义模板。